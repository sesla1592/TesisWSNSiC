<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
 	  xmlns:hs="http://xmlns.jcp.org/jsf/html"
 	  xmlns:p="http://primefaces.org/ui"
 	  xmlns:b="http://bootsfaces.net/ui"
 	  xmlns:hf="http://highfaces.org"
      xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"> 

<h:head></h:head> 
<body> 

<h:form id="formulario">
dashboard
<br/>
<a id="item1"  href="dashboard.xhtml">
	<span>Pagina principal</span>
</a>
<br/>
<a id="item1"  href="profile.xhtml">
	<span>Perfil</span>
</a>
<br/>
<a id="item1"  href="nodosuser.xhtml">
	<span>Mis Nodos</span>
</a>

<br/>

<script type="text/javascript" 
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCFPa3ras2hBSAdSpYCa7q83OF8fOgCL6g"></script>
  <p:growl id="growl" showDetail="true" />
 
       <p:gmap center="-2.892183,-79.0243996" zoom="13" type="roadmap" style="width:100%;height:400px"  model="#{dashboardUser.simpleModel}" >
	       <p:ajax event="overlaySelect" listener="#{dashboardUser.onMarkerSelect}"  update="listaNodos panelDatos"/>
	       <p:gmapInfoWindow id="infoWindow">
	            <p:outputPanel style="text-align: center; display: block; margin: auto">
	 
	                    <h:outputText value="#{dashboardUser.marker.title}" />
	                    <br/>
	                    <h:outputText value="Sensores:" />
	                    <br/>
	                    <ui:repeat value="#{dashboardUser.nodoSelected.ltssensores}" var="sensores">
						        
						            <h:outputText value="- #{sensores.nombre}" />
						        		<br/>
						    </ui:repeat>
	 
	            </p:outputPanel>
	        </p:gmapInfoWindow>
       </p:gmap>
       <h:panelGroup id="panelDatos">
       	datos sensor<br/>
       	Temperatura: #{dashboardUser.datoTemp}<br/>
       	Humedad: #{dashboardUser.datoHum}<br/>
       </h:panelGroup>
       <h:selectOneMenu id="listaNodos" value="#{dashboardUser.sensorSeleccionado}" >
		    
			<f:selectItems value="#{dashboardUser.ltsSensores}" var="sensorItem" itemValue="#{sensorItem}" itemLabel="#{sensorItem}"/>
		</h:selectOneMenu>
		<b:row>
				<hf:chart id="grafica" title="Mediciones" xaxisLabel="Tiempo"
					yaxisLabel="Valor" type="line" subTitle="Sensors into Cloud">
					<hf:chartSerie value="#{dashboardUser.ltsSTemp}" 
									var="point" 
									point="#{point.valor}" 
									tickLabel="#{point.fecha}"
									name="Temperatura"
									rendered="true"
									/>
					<hf:chartSerie value="#{dashboardUser.ltsSHum}" 
									var="point" 
									point="#{point.valor}" 
									tickLabel="#{point.fecha}"
									name="Humedad"
									rendered="false"
									/>
									
									<hf:chartLegend position="ne" title="Valores" layout="vertical" backgroundColor="#eeeeee"/>
									<hf:chartTooltip  backgroundColor="#000000" shared="true">
									<f:facet name="header">
            						<h:outputText escape="false" value="&lt;table>&lt;tr>&lt;td style='color:white;font-weight:bold;padding-right:5px;'>{point.key}&lt;/td>&lt;td style='border-left:1px solid white;padding-left: 10px;'>"/>
        							</f:facet>
        							<f:facet name="body">
        							<h:outputText value="&lt;span style='color:white'>{series.name}: &lt;b>{point.y}&lt;/b>&lt;/span>&lt;br/>"/>
        							</f:facet>
									</hf:chartTooltip>									
				</hf:chart>
		</b:row>		
		<b:commandButton action="#{dashboardUser.consulta()}" value="Graficar" update="grafica">
		</b:commandButton>
	
       </h:form>




</body> 
</html>
